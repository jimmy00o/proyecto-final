{% extends 'baseadmin.html' %}

{% block title %}Panel de AdministraciÃ³n{% endblock %}

{% block body %}

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <script>
        const Toast = Swal.mixin({
          toast: true,
          position: "top-end",
          showConfirmButton: false,
          timer: 2500,
          timerProgressBar: true,
          didOpen: (toast) => {
            toast.onmouseenter = Swal.stopTimer;
            toast.onmouseleave = Swal.resumeTimer;
          }
        });
        Toast.fire({
          icon: "{{ 'success' if category == 'success' else 'info' }}",
          title: "{{ message }}"
        });
      </script>
    {% endfor %}
  {% endif %}
{% endwith %}

<style>
  body {
    background: radial-gradient(circle at top left, #1b1b1b, #262626, #0f0f0f);
    color: #f8f9fa;
    font-family: 'Poppins', sans-serif;
    overflow-x: hidden;
  }

  .mf-stage { position: relative; isolation: isolate; }
  .mf-particles {
    position: absolute; inset: 0; z-index: 0; pointer-events: none; overflow: hidden;
  }
  .mf-particle {
    position: absolute; width: 10px; height: 10px; border-radius: 50%;
    background: radial-gradient(circle, #ff6a00, #ff2a00 60%, rgba(225, 169, 160, 0));
    box-shadow: 0 0 18px rgba(255, 90, 0, 0.95), 0 0 36px rgba(255, 140, 0, 0.6);
    opacity: .85; animation: mf-float 8s ease-in-out infinite; filter: saturate(1.05);
  }
  @keyframes mf-float {
    0%   { transform: translate(0,0) scale(1);   opacity:.7; }
    45%  { transform: translate(70px,-110px) scale(1.35); opacity:1; }
    100% { transform: translate(0,0) scale(1);   opacity:.75; }
  }

  .admin-title {
    background: linear-gradient(90deg, #ff3c00, #ffae00);
    color: #fff;
    border: none;
    border-radius: 10px;
    font-weight: 700;
    letter-spacing: 1px;
    box-shadow: 0 0 25px rgba(255, 60, 0, 0.5);
    text-shadow: 0 0 10px rgba(0, 0, 0, 0.6);
    position: relative; z-index: 1;
  }

  .card {
    border-radius: 15px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    position: relative; z-index: 1;
  }
  .card:hover {
    transform: translateY(-8px);
    box-shadow: 0 10px 25px rgba(255, 60, 0, 0.3);
  }

  .card-usuarios   { background: linear-gradient(180deg, #0f5132, #198754, #4ade80); color:#fff; }
  .card-publicar   { background: linear-gradient(180deg, #2a0000, #ff3c00, #ffae00); color:#fff; }
  .card-visualizar { background: linear-gradient(180deg, #0b235c, #3d85a9, #e0f7ff); color:#fff; }

  .btn-motoforce {
    border-radius: 25px;
    font-weight: 600;
    transition: 0.3s;
  }
  .btn-motoforce:hover {
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(255, 200, 0, 0.7);
  }

  .card i, .card svg {
    transition: transform 0.3s ease-in-out;
  }
  .card:hover i, .card:hover svg {
    transform: scale(1.15) rotate(-3deg);
  }

  .mf-handlebar { width: 100px; height: 100px; display:inline-block; filter: drop-shadow(0 6px 16px rgba(0,0,0,.35)); }
  .mf-handlebar .metal { stroke:#ffffff; stroke-width:2.5; fill:none; stroke-linecap:round; stroke-linejoin:round; }
  .mf-handlebar .grip  { fill:#ffffff; }
  .mf-handlebar .dial  { fill:#ff3c00; stroke:#ffffff; stroke-width:2; }
  .mf-handlebar .tick  { stroke:#ffffff; stroke-width:2; stroke-linecap:round; opacity:.95; }

  .fade-in { animation: fadeIn 1s ease-in-out; }
  @keyframes fadeIn { from {opacity:0; transform:translateY(20px);} to {opacity:1; transform:translateY(0);} }

  /* Tooltip negro elegante */
  .tooltip-inner {
    background-color: #000 !important;
    color: #fff !important;
    font-weight: 600;
    font-size: 0.9rem;
    border-radius: 6px;
    padding: 8px 12px;
    box-shadow: 0 0 12px rgba(255, 255, 255, 0.2);
  }
  .tooltip.bs-tooltip-top .tooltip-arrow::before { border-top-color: #000 !important; }
  .tooltip.bs-tooltip-bottom .tooltip-arrow::before { border-bottom-color: #000 !important; }

  .counter {
    font-size: 2rem;
    font-weight: 700;
    margin-top: 8px;
    color: #fff;
    text-shadow: 0 0 10px rgba(0,0,0,0.6);
  }
</style>

<div class="mf-stage">

  <div class="mf-particles">
    <span class="mf-particle" style="top:10%; left:12%; animation-delay:.1s;"></span>
    <span class="mf-particle" style="top:28%; left:72%; animation-delay:1.1s;"></span>
    <span class="mf-particle" style="top:48%; left:42%; animation-delay:2.2s;"></span>
    <span class="mf-particle" style="top:78%; left:82%; animation-delay:.6s;"></span>
    <span class="mf-particle" style="top:62%; left:9%;  animation-delay:1.7s;"></span>
    <span class="mf-particle" style="top:22%; left:53%; animation-delay:.9s;"></span>
    <span class="mf-particle" style="top:70%; left:30%; animation-delay:2.6s;"></span>
  </div>

  <div class="container p-5 mt-3 fade-in">
    <h2 class="text-center admin-title py-4 mb-5 shadow-sm">
      ðŸš€ Panel de AdministraciÃ³n MotoForce
    </h2>

    <div class="row text-center g-4">

      <!-- Usuarios Registrados -->
      <div class="col-sm-4">
        <div class="card card-usuarios text-white shadow-lg border-0"
             data-bs-toggle="tooltip" data-bs-placement="bottom"
             title="Administra y controla los usuarios registrados en la plataforma.">
          <div class="card-body d-flex flex-column align-items-center justify-content-center py-5">
            <i class="bi bi-people-fill display-1 mb-3"></i>
            <h5 class="card-title fw-bold">Usuarios Registrados</h5>
            <div class="counter">{{ total_usuarios }}</div>
            <p class="card-text" style="font-size: 0.9rem;">Visualiza y gestiona todos los usuarios activos.</p>
            <a href="{{ url_for('lista_usuarios') }}" class="btn btn-light btn-motoforce mt-3 w-75"
               data-bs-toggle="tooltip" data-bs-placement="bottom"
               title="Haz clic para ver todos los usuarios registrados.">Ver Detalles</a>
          </div>
        </div>
      </div>

      <!-- Publicar Nueva Moto -->
      <div class="col-sm-4">
        <div class="card card-publicar text-white shadow-lg border-0"
             data-bs-toggle="tooltip" data-bs-placement="bottom"
             title="Agrega una nueva motocicleta al inventario disponible para los clientes.">
          <div class="card-body d-flex flex-column align-items-center justify-content-center py-5">
            <svg class="mf-handlebar" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <circle cx="35" cy="90" r="10" fill="#fff"/>
              <circle cx="95" cy="90" r="10" fill="#fff"/>
              <rect x="55" y="55" width="18" height="8" rx="2" ry="2" fill="#fff"/>
              <path d="M40 70h48l7 10h-8l-5-6H47l-4 6h-8z" fill="#fff"/>
            </svg>
            <h5 class="card-title fw-bold mt-2">Publicar Nuevas Motos</h5>
            <div class="counter">{{ total_motos }}</div>
            <p class="card-text" style="font-size: 0.9rem;">Registra nuevas motocicletas disponibles para venta.</p>
            <a href="{{ url_for('listar_productos_agregados') }}" class="btn btn-light btn-motoforce mt-3 w-75"
               data-bs-toggle="tooltip" data-bs-placement="bottom"
               title="Haz clic para agregar una nueva moto al sistema.">Publicar</a>
          </div>
        </div>
      </div>

      <!-- Visualizar Productos -->
      <div class="col-sm-4">
        <div class="card card-visualizar text-white shadow-lg border-0"
             data-bs-toggle="tooltip" data-bs-placement="bottom"
             title="Consulta el listado completo de motocicletas y productos registrados en el sistema.">
          <div class="card-body d-flex flex-column align-items-center justify-content-center py-5">
            <i class="bi bi-card-list display-1 mb-3"></i>
            <h5 class="card-title fw-bold">Visualizar Productos</h5>
            <div class="counter">{{ total_productos }}</div>
            <p class="card-text" style="font-size: 0.9rem;">Accede a todos los productos actualmente registrados.</p>
            <a href="{{ url_for('listar_productos') }}" class="btn btn-light btn-motoforce mt-3 w-75"
               data-bs-toggle="tooltip" data-bs-placement="bottom"
               title="Ver el catÃ¡logo completo de motos y productos.">Ver Detalles</a>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    const tooltips = tooltipTriggerList.map(function (el) {
      return new bootstrap.Tooltip(el);
    });

    // Mostrar solo un tooltip a la vez
    tooltipTriggerList.forEach((el, idx) => {
      el.addEventListener('mouseenter', () => {
        tooltips.forEach((tt, i) => { if (i !== idx) tt.hide(); });
      });
      el.addEventListener('mouseleave', () => {
        tooltips[idx].hide();
      });
    });
  });
</script>

{% endblock %}
